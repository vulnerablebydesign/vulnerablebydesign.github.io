<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Browse Hack the Cube posts by tag - OS, difficulty, techniques, tools, and characters.">
  <meta name="theme-color" content="#0a0a0f">
  <title>Tags | Hack the Cube</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/blog/assets/images/favicon.png">

  <!-- Styles -->
  <link rel="stylesheet" href="/blog/assets/styles/blog.css">
</head>
<body>
  <div class="blog-container">

    <!-- Header -->
    <header class="blog-header" style="padding: 2rem 0;">
      <a href="/blog/">
        <img
          src="/blog/assets/images/hack-the-cube-header.png"
          alt="Hack the Cube"
          class="header-image"
          style="max-height: 150px; width: auto;"
        >
      </a>
    </header>

    <!-- Title -->
    <div style="text-align: center; margin-bottom: 2rem;">
      <h1 style="font-family: var(--font-pixel); font-size: 1.2rem; color: var(--terminal-green);">
        TAG INDEX
      </h1>
      <p style="color: var(--text-secondary);">Browse test chambers by category</p>
    </div>

    <!-- Navigation -->
    <nav class="blog-nav" aria-label="Blog navigation">
      <a href="/blog/" class="nav-link">All Posts</a>
      <a href="/blog/tags/" class="nav-link active">Tags</a>
      <a href="/" class="nav-link">Main Terminal</a>
    </nav>

    <!-- Tags Content -->
    <main id="tags-content" style="max-width: 800px; margin: 0 auto;">
    </main>

    <!-- Footer -->
    <footer class="blog-footer">
      <p class="footer-text">
        <a href="/blog/" class="footer-link">Back to Test Chamber Archives</a>
      </p>
    </footer>

  </div>

  <script>
    const CHARACTER_TAGS = new Set([
      'glados', 'wheatley', 'fact-sphere', 'curiosity-core', 'adventure-sphere'
    ]);

    const CATEGORIES = [
      { name: 'CHARACTERS', tags: ['glados', 'wheatley', 'fact-sphere', 'curiosity-core', 'adventure-sphere'] },
      { name: 'TYPE', tags: ['machine', 'sherlock'] },
      { name: 'OPERATING SYSTEMS', tags: ['linux', 'windows'] },
      { name: 'DIFFICULTY', tags: ['very-easy', 'easy', 'medium', 'hard', 'insane'] },
      { name: 'TECHNIQUES', tags: ['rce', 'ssti', 'privesc', 'suid', 'reverse-shell', 'steganography', 'irc', 'ssh', 'web', 'sqli', 'php', 'ldap', 'winrm', 'active-directory', 'credential-stuffing', 'cve', 'dfir', 'path-traversal', 'ntlm'] },
      { name: 'TOOLS', tags: ['nmap', 'burpsuite', 'snmp', 'cups', 'wireshark', 'pcap'] },
      { name: 'SERVICES', tags: ['printer', '3d-printer', 'telnet'] }
    ];

    function getTagClass(tag) {
      return CHARACTER_TAGS.has(tag) ? `tag ${tag}` : 'tag';
    }

    async function init() {
      try {
        const response = await fetch('/blog/posts.json');
        const posts = await response.json();

        // Count posts per tag
        const tagCounts = {};
        posts.forEach(post => {
          post.tags.forEach(tag => {
            tagCounts[tag] = (tagCounts[tag] || 0) + 1;
          });
        });

        const container = document.getElementById('tags-content');
        let html = '';

        CATEGORIES.forEach(category => {
          // Only show tags that have posts
          const activeTags = category.tags.filter(t => tagCounts[t]);
          if (activeTags.length === 0) return;

          html += `
      <section style="margin-bottom: 3rem;">
        <h2 style="font-family: var(--font-pixel); font-size: 0.9rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-dim);">
          ${category.name}
        </h2>
        <div class="tags-container" style="gap: 1rem;">
          ${activeTags.map(t =>
            `<a href="/blog/tags/tag.html?tag=${encodeURIComponent(t)}" class="${getTagClass(t)}" style="font-size: 1rem; padding: 0.5rem 1rem;">${t} <span style="opacity: 0.6; font-size: 0.8em;">(${tagCounts[t]})</span></a>`
          ).join('\n          ')}
        </div>
      </section>`;
        });

        container.innerHTML = html;
      } catch (err) {
        document.getElementById('tags-content').innerHTML =
          '<p style="text-align: center; color: var(--error-red); padding: 2rem;">Failed to load tags.</p>';
      }
    }

    init();
  </script>
</body>
</html>
